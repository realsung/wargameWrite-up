from pwn import *
import os

#stage1
s1_val=[str(i) for i in range(100)]
s1_val[ord('A')]='\x00'
s1_val[ord('B')]='\x20\x0a\x0d'

#stage2
with open('./stderr','a') as f:
        f.write('\x00\x0a\x02\xff')

#stage3
s3_val={'\xde\xad\xbe\xef':'\xca\xfe\xba\xbe'}

#stage4
with open('./\x0a','a') as f:
        f.write('\x00\x00\x00\x00')

#stage5
s1_val[ord('C')]='77777'

p=process(executable='/home/input2/input',argv=s1_val,stderr=open('./stderr'),env=s3_val)
print p.recv(1024)
p.sendline('\x00\x0a\x00\xff')
print p.recv(1024)

c = remote('127.0.0.1',77777)
c.sendline('\xde\xad\xbe\xef')
print p.recv(1024)
p.interactive()